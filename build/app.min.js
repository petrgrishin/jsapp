(function(){var a,b,c,d,e,f,g,h;a=function(){function a(){this.assertPath="/assets/scripts/",this.viewFunctions={},this.registerScripts={},this.registerStyles={},null==this.scope&&(this.scope=new g)}return a.prototype.register=function(a,b){return this.viewFunctions[a]=b},a.prototype.run=function(a,b,c){var d,e,f;return this.registerScriptFile(a),b=b||{},c=c||[],f=[],e=function(a,b){var c,d,e;return d=a.name,e=a.params,c=a.dependents,f[b]=this.run(d,e,c)},_.each(c,e,this),(d=this.viewFunctions[a])(b,this.scope,f)},a.prototype.registerScriptFile=function(a){var b;if(null==this.registerScripts[a])return this.registerScripts[a]=this.assertPath+a+".js",b=$("<script>"),b.attr("src",this.registerScripts[a]),null==this.body&&(this.body=$("body:first")),this.body.append(b)},a.prototype.registerStyleFile=function(a){var b;if(null==this.registerStyles[a])return this.registerStyles[a]=!0,b=$('<link rel="stylesheet"/>'),b.attr("href",a),null==this.head&&(this.head=$("head:first")),this.head.append(b)},a}(),b=function(){function a(){this.subscribers={}}return a.prototype.trigger=function(a,b){return null==b&&(b={}),this.subscribers[a]&&_.each(this.subscribers[a],function(a){return a(b)}),this},a.prototype.subscribe=function(a,b){var c;return null==(c=this.subscribers)[a]&&(c[a]=[]),this.subscribers[a].push(b),this},a.prototype.clear=function(a){return this.subscribers[a]=[],this},a}(),c=function(){function a(a){this.response=a}return a.prototype.pull=function(a,b){var c;return null==b&&(b={}),c=this,$.ajax({url:a,data:b.data||{},type:b.type||"GET",dataType:"json",success:function(a){var b,d,e,f,g;return a?(a.content&&c.response.setContent(a.content),a.responseParams?c.response&&c.response.triggerApply(a.responseParams):c.response.triggerLoad(),e=a.params||[],d=a.dependents||[],a.name&&(b=window.App.run(a.name,e,d),c.response.setContext(b),c.response.triggerContext()),g=a.styles||[],f=function(a){return window.App.registerStyleFile(a)},_.each(g,f)):void 0}})},a}(),d=function(){function a(){}return a}(),e=function(){function a(){}return a}(),f=function(){function a(a){this.params=a,this.listener=new b}return a.prototype.getParams=function(){return this.params},a.prototype.bindLoad=function(a){return this.listener.subscribe("load",_.bind(a,this))},a.prototype.triggerLoad=function(){return this.listener.trigger("load")},a.prototype.bindApply=function(a){return this.listener.subscribe("apply",_.bind(a,this))},a.prototype.triggerApply=function(){return this.listener.trigger("apply")},a.prototype.bindContext=function(a){return this.listener.subscribe("context",_.bind(a,this))},a.prototype.triggerContext=function(){return this.listener.trigger("context")},a.prototype.setContent=function(a){this.content=a},a.prototype.getContent=function(){return this.content},a.prototype.setContext=function(a){this.context=a},a.prototype.getContext=function(){return this.context},a.prototype.clearApply=function(){return this.listener.clear("apply")},a.prototype.clearLoad=function(){return this.listener.clear("load")},a.prototype.clearContext=function(){return this.listener.clear("context")},a}(),g=function(){function a(){}return a.prototype.createListener=function(){return new b},a.prototype.createResponse=function(){return new f},a.prototype.createLoader=function(a){return new c(a)},a.prototype.$id=function(a){return $(window.document.getElementById(a))},a}(),h=function(){function a(){}return a.prototype.apply=function(){return this.response?this.response.apply():void 0},a.prototype.onApply=function(a){if(!a instanceof f)throw"Not instance of Response";return this.response=a},a}(),"undefined"!=typeof module&&null!==module&&(module.exports=a),"undefined"!=typeof window&&null!==window&&(window.App=new a(window))}).call(this);